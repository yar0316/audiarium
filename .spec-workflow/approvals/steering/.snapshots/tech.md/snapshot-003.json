{
  "id": "snapshot_1764684219832_bw8j9ac24",
  "approvalId": "approval_1764684209214_tj55mpbmw",
  "approvalTitle": "Tech Stack - Next.js 16 + Supabase + Flutter 構成（修正版）",
  "version": 3,
  "timestamp": "2025-12-02T14:03:39.832Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Technology Stack\r\n\r\n## Project Type\r\n\r\nクロスプラットフォーム音楽管理・再生アプリケーション。Web アプリケーション + モバイルアプリ + API サービスのハイブリッド構成。\r\n\r\n## Core Technologies\r\n\r\n### Primary Language(s)\r\n- **TypeScript**: Web フロントエンド・API（Next.js）\r\n- **Dart**: モバイルアプリ（Flutter）\r\n- **Runtime**: Node.js 20+\r\n\r\n### Key Dependencies/Libraries\r\n\r\n**Web (Next.js)**\r\n- **Next.js 16**: フルスタックフレームワーク（App Router）\r\n- **React 19**: UI ライブラリ\r\n- **Tailwind CSS 4**: スタイリング\r\n- **Howler.js**: Web Audio 再生\r\n- **@supabase/supabase-js**: Supabase クライアント\r\n\r\n**Mobile (Flutter)** ※後日実装\r\n- **Flutter 3.x**: クロスプラットフォームモバイルフレームワーク\r\n- **just_audio**: 音楽再生\r\n- **supabase_flutter**: Supabase クライアント\r\n\r\n### Application Architecture\r\n\r\n```\r\n┌─────────────────────────────────────────────────┐\r\n│                    Vercel                       │\r\n│  ┌───────────────────────────────────────────┐  │\r\n│  │              Next.js 16                   │  │\r\n│  │  ┌─────────────┐  ┌─────────────────┐     │  │\r\n│  │  │  Web UI     │  │   API Routes    │     │  │\r\n│  │  │  (React)    │  │   (/api/*)      │     │  │\r\n│  │  └─────────────┘  └────────┬────────┘     │  │\r\n│  └────────────────────────────┼──────────────┘  │\r\n└───────────────────────────────┼─────────────────┘\r\n                                │ REST API\r\n          ┌─────────────────────┼─────────────────────┐\r\n          │                     │                     │\r\n          ▼                     ▼                     ▼\r\n  ┌───────────────┐    ┌───────────────┐    ┌───────────────┐\r\n  │    Flutter    │    │   Supabase    │    │   Supabase    │\r\n  │    (Mobile)   │    │  PostgreSQL   │    │    Storage    │\r\n  └───────────────┘    └───────────────┘    └───────────────┘\r\n```\r\n\r\n### Data Storage\r\n- **Primary storage**: Supabase (PostgreSQL) ※Vercel Integration で環境変数を自動連携\r\n- **File storage**: Supabase Storage（MP3 ファイル）\r\n- **Caching**: なし（個人利用のため不要）\r\n- **Data formats**: JSON（API）、MP3（音楽ファイル）\r\n\r\n### External Integrations\r\n- **Supabase**: DB、Storage、Auth\r\n- **Vercel**: ホスティング・デプロイ\r\n- **Protocols**: HTTP/REST\r\n- **Authentication**: Supabase Auth（Email/Password）\r\n\r\n## Development Environment\r\n\r\n### Build & Development Tools\r\n- **Build System**: Next.js built-in（Turbopack）\r\n- **Package Management**: npm / pnpm\r\n- **Development workflow**: `next dev --turbopack`（Hot Reload）\r\n\r\n### Code Quality Tools\r\n- **Static Analysis**: ESLint\r\n- **Formatting**: Prettier\r\n- **Testing Framework**: Vitest（予定）\r\n- **Type Checking**: TypeScript strict mode\r\n\r\n### Version Control & Collaboration\r\n- **VCS**: Git\r\n- **Repository**: GitHub\r\n- **Branching Strategy**: GitHub Flow（main + feature branches）\r\n\r\n## Deployment & Distribution\r\n\r\n### Web\r\n- **Platform**: Vercel（Serverless）\r\n- **Distribution**: URL アクセス\r\n- **CI/CD**: Vercel 自動デプロイ（GitHub 連携）\r\n\r\n### Mobile ※後日\r\n- **Platform**: iOS / Android\r\n- **Distribution**: 個人利用（App Store 非公開）\r\n\r\n## Technical Requirements & Constraints\r\n\r\n### Performance Requirements\r\n- 音楽再生のレイテンシ: 1秒以内に再生開始\r\n- API レスポンス: 500ms 以内\r\n- ファイルアップロード: 50MB まで対応\r\n\r\n### Compatibility Requirements\r\n- **Web**: Chrome, Safari, Firefox（最新版）\r\n- **Mobile**: iOS 15+, Android 10+\r\n\r\n### Security & Compliance\r\n- **Authentication**: Supabase Auth\r\n- **API Protection**: 認証必須\r\n- **Storage**: Supabase RLS（Row Level Security）\r\n\r\n### Scalability & Reliability\r\n- **Expected Load**: 1ユーザー（個人利用）\r\n- **Availability**: 最低限（Vercel 無料枠で十分）\r\n\r\n## Technical Decisions & Rationale\r\n\r\n### Decision Log\r\n\r\n1. **Next.js API Routes vs 専用バックエンド**\r\n   - 選択: Next.js API Routes\r\n   - 理由: 個人利用で規模が小さい、Vercel 無料枠で運用可能、インフラ管理不要\r\n\r\n2. **Supabase vs Firebase**\r\n   - 選択: Supabase\r\n   - 理由: PostgreSQL ベースで SQL が使える、無料枠が十分、Storage 機能付き\r\n\r\n3. **Flutter vs React Native**\r\n   - 選択: Flutter\r\n   - 理由: 単一コードベースで iOS/Android 対応、パフォーマンス良好\r\n\r\n4. **Tailwind CSS vs CSS Modules**\r\n   - 選択: Tailwind CSS\r\n   - 理由: ユーザーが慣れている、高速な UI 開発\r\n\r\n## Known Limitations\r\n\r\n- **Vercel 無料枠制限**: Serverless Function 実行時間 10秒、帯域制限あり\r\n- **Supabase 無料枠制限**: Storage 1GB、DB 500MB\r\n- **オフライン非対応**: Web 版はオンライン必須（PWA 化は将来検討）\r\n",
  "fileStats": {
    "size": 5836,
    "lines": 137,
    "lastModified": "2025-12-02T14:03:07.745Z"
  },
  "comments": []
}